# The note about the Excel learning

注明：该笔记以Ms office 365版本的Excel为例

## 如何导入不同类型的数据

注明：主要通过Power Query编辑器进行操作

- 从文本导入

  - 进入数据
  - 选择从文本/CSV导入
  - 选择需要导入文件(.txt)
  - 选择转换数据
    - 日期则选择日期
    - 超过15位数的数字，则选择文字类型
    - 如果要删除可以使用shift快捷键来快速选择
  - 关闭并上载

- 从网页导入

  - 进入数据
  - 选择从网站导入
  - 输入网站URL
  - 选择要选择的对象
    - 若是单个则直接点table n，然后进行转换数据等具体操作
    - 若是多个则勾选选择多项进行具体操作
    - 若是所有，则选择父文件夹，通常就是最上面，黄色图标的
  - 进入后，根据需求选择保留哪些列，一般是仅仅保留data列，若是如此，则删除其他列。
  - 选择顶格右侧的拓展设置，进行勾选是否使用原始列名
  - 最后同文本

- 从图片导入

  - 第一种是扫描图，还有一种是日常手机等电子设备生成的图片
  - 通过导入进OCR软件（进行文本识别，这里推荐汉王OCR）
  - 按f5进行区域划分
  - 按f8进行识别
  - 识别结果生成后，进行进一步修改
  - 最后导出成excel相关文件，进一步处理数据

- 从数据库导入数据

  - 点击数据
  - 获取数据
    - 从数据库导入数据
    - 选择MS Access
    - 同上

  

  

  

  注：若想去除默认表样式，可以在表设计里面，清除表的样式。

  

## 实现报表数据汇总

使用快捷键'alt'+'='实现自动求和，规定方向是：自上到下或者自左到右，反正就是所学内容之后显示。然后也可以使用=SUM(A1:An)这种求和公式进行计算。



## 实现数据差异对比

- 通过选中对比列，通过快捷键'ctrl'+'\'来实现===原理是按照行内容差异的单元格来定位，并且以选中的单元格为基准位置来定位。所以基准列就是选中的单元格的所在列
  - 如果基准列是在中间，则需要使用tab键来调整
- 或者选中内容后，通过f5，选择定位条件，再选择相应的差异标准



## 数据填充和数据合并

通过输入一些表格后，使用'ctrl'+'e'来实现填充。或者在开始界面选择填充，再选择快速填充来实现。数据合并做法一样。Excel会根据规律填充和合并。总之，Excel能完成机械式的填充和智能的填充。



## 美化报表格式

- 选中左上角，通过'ctrl'+'t'来实现超级表的样式，颜色可以在表设计里面更改
- 或者在表中间，然后按'ctrl'+'l'来实现
- 或者在插入里面，选择表格
- 当然如果要取消超级表，就在表设计里面通过"转换为区域"这个选项来实现

注：要注意所选表有没有包含标题



## 录入

- 数值

  - 通过数字***数字，这种科学计数法方式实现，如果想要转化成普通形式，通过'ctrl'+'shift'+'`'来实现，当然也可以在开始中选择常规格式

- 长文本

  - 1
    - 通过数据中
    - 选择数据验证
    - 选择来源
  - 2
    - 复制超长单位名称
    - 选择文件
    - 选择最下面的选项
    - 选择校对
    - 选择自动更正
    - 替换中写被替换量，后面为是写要更正成的量
    - 然后在excel中写前者按回车能自动替换
    - 注意这个的通用性，包括word等都会自动替换

  

## 添加前缀后缀

- 通过公式实现

  =“所需字符串，即前缀”&（这个是连接符）A1

  当然双引号是英文模式打出来的，其中引用可以是别的sheet；原理是相对引用

  后缀实现方法相似

- 第二种通过绝对引用
  - 在表格空白区域提前打出前后缀，然后=后面选择区域，将要加的前后缀的表格选中，再按f4
  - 这样的优点是，可以在前后缀的单元格中更改来实现更改，而不需要再次更改



## 单工作表多区域录入

- 选择区域按住ctrl键
- 然后在输入框输入后，按'ctrl'+'shift'

- 批量输入随机数通过在输入框中，输入randbetween(a,b)。然后可以按f9进行随机数刷新



## 多工作表单区域录入

- 按住一个工作表后，通过ctrl键来xuanze其他工作表，形成工作表组；如果表之前是连续的，也可以通过shift键来快速选择
- 然后可以在一个表中进行具体的数据编辑或者数据录入
- 取消组合：单击+鼠标右键+取消
  - 或者直接单机其他工作表



## 多工作表单进行批量计算

同上，以及通过快捷键；应该是要在相同的区域的



## 如何快速删除重复行

![image-20220610223452744](C:\Users\浅夏 hello\AppData\Roaming\Typora\typora-user-images\image-20220610223452744.png)



- 选中第一列
- 启用筛选
- 筛选结果删除多于重复行(可以通过'ctrl'+'shift'+'⬇'实现快速选择)
- 然后取消筛选



## 如何美化一些不规范的表格(比如文本识别后导入的表格)

- 取消识别的身份证号后面空格
  - 使用=left(选择区域，截取前几位)



## 如何将文本数值转换为规范的数值（否则会导致报表中的数值无法正常统计）

- 通过选择粘贴

  - 先选择空白单元格
  - 然后选择文本数值区域
  - 右击选择选择性粘贴
  - 选择数值和运算加（如果是默认的话，将会破坏选中区域格式，因为第一个选中的空白单元格没有格式）

  - 最后如果想要调整数字的位数，可以选中后进行单元格格式设置



原理：通过加减乘除可以将文本数值规范为正常的数值



## 整列伪日期（文字、常规或者空格）数据如何批量转换格式

正常格式：2019-2-1、2019/2/1

提取函数：year();month()函数

1.文字情况（20190201）下修复方法：

- 选中整列
- 数据--分列
- 选中里面的日期格式

2.常规（2019.2.1）情况下修复方法：

同上

3.空格情况下修复方法：

- 首先通过替换将空格换成空
- 然后同上

## 如何处理报表格式错乱









































## 快捷键

- ctrl -
  - 表示删除表格
- ctrl ⬆ ⬇ 
  - 表示快速跳转到顶部/顶部
- alt Tab
  - 表示不同应用界面跳转
- 选中按住shift不动
  - 快速选择多行多列
- 自动求和
  - Alt =
- 快速填充
  - ctrl e
- 如何实现数字转文本
  - 通过在数字前面加’来实现
  - 或者直接将单元格转换成文本格式



## Excel输入内容表格显示错误

- ######！
  - 表示输入数据或者计算内容的长度超出范围
  - 还有可能进行日期或者时刻加减的时候出现负值
  - 或者是因为出发公式，除数是0/或者指向的是空单元格
- #VALUE!
  - 有可能是因为需要数字或逻辑值的时候输入了文本数据
  - 也有可能是在需要符单一数据的运算符或函数的时候，赋给了一个数值区域
- #NAME?
  - 不能识别文本而产生
  - 或者因为删除公式中一些正在利用的数据或利用了不存在的数据和显现拼写错误
- #N/A
  - 函数或公式顶用到的数值不存在而产生的错误
- #REF!
  - 单元格引用无效的结果
  - 可能是因为删除有其他要引用的单元格，或移动单元格粘贴到了其他公式引用的单元中
- 单元格中左上角的绿色小三角
  - 提示该单元格是文本格式



